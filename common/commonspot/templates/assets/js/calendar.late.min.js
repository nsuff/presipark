function initEventCalendarPage(){EVENTS_API_BASE_URL=getApiUrl();var e=jQuery(".EventCalendarPage").length>0;e&&(initMultiSelectFields(),initCollapsibleForms(),initDatePicker(),registerEventHandlers(),setStartDate(moment().format("YYYY-MM-DD")).done(submitForm))}function getApiUrl(){var e=EVENTS_API_BASE_URL,t=document.getElementById("SelectedPark").value;return t&&(e+="&parkCode="+t),e}function initMultiSelectFields(){document.getElementsByClassName("MultiSelect").length>0&&jQuery(".MultiSelect").multiselect({enableClickableOptGroups:!0,maxHeight:300,buttonWidth:"100%",buttonClass:"btn btn-default btn-lg",numberDisplayed:0,nonSelectedText:jQuery(this).attr("data-placeholder")||"All",enableFiltering:!0,enableCaseInsensitiveFiltering:!0,onChange:submitForm});var e=document.getElementById("SelectedPark").value.length<1,t=1==document.getElementById("showFilterByPark").value;e?(document.getElementsByClassName("EventCalendar__SearchForm__ChoosePark")[0].style.display="block",document.getElementsByClassName("EventCalendar__SearchForm__ChooseState")[0].style.display="block",document.getElementsByClassName("EventCalendar__SearchForm__ChooseEventType")[0].style.display="block"):(document.getElementsByClassName("EventCalendar__SearchForm__ChoosePark")[0].style.display="none",document.getElementsByClassName("EventCalendar__SearchForm__ChooseState")[0].style.display="none",document.getElementsByClassName("EventCalendar__SearchForm__ChooseEventType")[0].style.display="block",document.getElementsByClassName("EventCalendar__SearchForm__ChooseEventType")[0].querySelectorAll(".EventCalendar__SearchForm__InputHeader")[0].style.paddingTop="0"),t?document.getElementsByClassName("EventCalendar__SearchForm__ChoosePark")[0].style.display="block":document.getElementsByClassName("EventCalendar__SearchForm__ChoosePark")[0].style.display="none"}function initCollapsibleForms(){document.getElementById("CollapsibleFormHeading").addEventListener("click",function(){document.width>=768&&(e.preventDefault(),e.stopPropagation())}),window.addEventListener("resize",toggleCollapsibleForms)}function toggleCollapsibleForms(){document.width<768?jQuery(".CollapsibleForm").collapse("hide"):jQuery(".CollapsibleForm").collapse("show")}function initDatePicker(){jQuery("#DatePicker").datepicker({todayBtn:!1,multidate:!1,autoclose:!1,todayHighlight:!1,immediateUpdates:!0}).on("changeMonth",function(e){handleDatePickerChangeMonth(e)}).on("changeDate",function(e){handleDatePickerSelectDay(e)}),showForm()}function registerEventHandlers(){document.getElementById("FormResetButton").addEventListener("click",resetForm),document.getElementById("ShowRepeatedEvents").addEventListener("change",submitForm),document.getElementsByClassName("EventCalendar__SearchBar__SubmitButton")[0].addEventListener("click",submitForm),[].forEach.call(document.getElementsByClassName("ResultsFilterButton"),function(e){e.addEventListener("click",handleChangeViewType)}),[].forEach.call(document.querySelectorAll('[data-toggle="tooltip"]'),function(e){e.addEventListener("click",handleToolTipClick)}),[].forEach.call(document.querySelectorAll("input"),function(e){e.addEventListener("keydown",function(e){13==e.which&&(e.preventDefault(),submitForm())})})}function submitForm(){showLoadingOverlay();var e=createUrlFromForm(),t=getSelectedView(),n=getStartAndEndDates();displayEvents(t,e,n.startDate,n.endDate)}function selectView(e){var t=jQuery.Deferred();return jQuery(".ResultsFilterButton").removeClass("selected"),jQuery('.ResultsFilterButton[data-value="'+e+'"]').addClass("selected")&&t.resolve(),t}function selectDateInDatePicker(e){var t=moment(e,"YYYY-MM-DD").toDate();jQuery("#DatePicker").datepicker("setDate",t)}function createUrlFromForm(){var e=jQuery("#SelectedPark").val().length>0&&jQuery("#SelectedPark").val(),t=jQuery("#ChoosePark").val(),n=jQuery("#ChooseState").val(),a=jQuery("#ChooseEventType").val(),s=jQuery("#form-keyword").val(),i=jQuery("#organization").val(),r=jQuery("#subject").val(),o=jQuery("#portal").val(),l=jQuery("#tagsAll").val(),d=jQuery("#tagsOne").val(),c=jQuery("#tagsNone").val(),u=jQuery("#ShowRepeatedEvents")[0].checked,m=getStartAndEndDates(),v="";return v+=EVENTS_API_BASE_URL,v+="&dateStart="+m.startDate,v+="&dateEnd="+m.endDate,i.length>0&&(v+="&organization="+i),r.length>0&&(v+="&subject="+encodeURIComponent(r)),o.length>0&&(v+="&portal="+o),l.length>0&&(v+="&tagsAll="+encodeURIComponent(l)),d.length>0&&(v+="&tagsOne="+encodeURIComponent(d)),c.length>0&&(v+="&tagsNone="+encodeURIComponent(c)),null===t||e||(v+="&parkCode="+t),null===n||e||(v+="&stateCode="+n),null!==a&&(v+="&eventType="+encodeURIComponent(a)),s.length>0&&(v+="&q="+encodeURIComponent(s)),u||(v+="&expandRecurring=true"),v}function getStartAndEndDates(){var e,t=getStartDate(),n=getSelectedView(),a=moment(t,"YYYY-MM-DD");switch(n){case"day":t=a.format("YYYY-MM-DD"),e=t;break;case"week":t=a.startOf("week").format("YYYY-MM-DD"),e=moment(t,"YYYY-MM-DD").endOf("week").format("YYYY-MM-DD");break;default:t=a.format("YYYY-MM-DD"),e=a.endOf("month").format("YYYY-MM-DD")}return{startDate:t,endDate:e}}function handleChangeViewType(e,t){t||(t=e.target.getAttribute("data-value")),selectView(t).done(function(){var e=getStartAndEndDates();setStartDate(e.startDate).done(submitForm)})}function handleDatePickerChangeMonth(e){var t=moment(e.date,"YYYY-MM-DD").startOf("month").format("YYYY-MM-DD");setStartDate(t).done(function(){selectView("month").done(submitForm)})}function handleDatePickerSelectDay(e){var t=moment(e.date).format("YYYY-MM-DD"),n=getSelectedDayFromDatePicker();if(n)setStartDate(t).done(function(){selectView("day").done(submitForm)});else{var a=moment(getStartDate(),"YYYY-MM-DD").startOf("month").format("YYYY-MM-DD");setStartDate(a).done(function(){selectView("month").done(submitForm)})}}function handleToolTipClick(e){var t=e.currentTarget;t.focus(),document.addEventListener("touchstart",function(e){jQuery(t).tooltip("hide")})}function showForm(){document.getElementById("EventCalendar__FormContainer").style.display="block"}function resetForm(){location.reload()}function clearCalendarDots(){jQuery(".EventCalendar__Calendar__Marker").css("visibility","hidden")}function setStartDate(e){var t=jQuery.Deferred(),n=moment(e,"YYYY-MM-DD");return document.getElementById("SelectedDate").value=n.format("YYYY-MM-DD"),t.resolve(),t.promise()}function getStartDate(e){return document.getElementById("SelectedDate").value}function getStartOfCurrentMonthShown(){return moment(getStartDate(),"YYYY-MM-DD").startOf("month").format("YYYY-MM-DD")}function getEndOfCurrentMonthShown(){return moment(getStartDate(),"YYYY-MM-DD").endOf("month").format("YYYY-MM-DD")}function displayEvents(e,t,n,a){var s=jQuery("#ResultsPagination");clearCalendarDots(),s.pagination({dataSource:t,pageNumber:1,locator:"data",className:"pagination",ulClassName:"pagination",hideWhenLessThanOnePage:!1,totalNumberLocator:function(e){if(e.dates.length>0){var t=e.dates.split(","),a=new Date(n),s=t.filter(function(e){var t=new Date(e);return t>=a});populateCalendar(s)}return e.total},pageSize:10,callback:function(e,t){populateResultsHeader(t,n,a),e.length>0?(showPagination(),populateResults(e),hideLoadingOverlay()):(showNoResultsTemplate("month",n,a),hideLoadingOverlay())}})}function getSelectedDayFromDatePicker(){var e=jQuery("#DatePicker").datepicker("getDate");return"Invalid Date"!=e&&moment(e).format("YYYY-MM-DD")}function hideLoadingOverlay(){document.getElementsByClassName("LoadingOverlay")[0].style.display="none",document.getElementsByClassName("ResultsContent")[0].style.display="block"}function showLoadingOverlay(){document.getElementsByClassName("LoadingOverlay")[0].style.display="block",document.getElementsByClassName("ResultsContent")[0].style.display="none"}function repeatingEventsAreHidden(){return jQuery("#ShowRepeatedEvents").is(":checked")}function populateCalendar(e){clearCalendarDots(),[].forEach.call(e,function(e){var t=moment(e,"YYYY-MM-DD"),n=jQuery("#CalendarDay__"+t.month()+"__"+t.date()+"__"+t.year()).children(".EventCalendar__Calendar__Marker");n.css("visibility","visible")})}function getSelectedView(){return jQuery(".ResultsFilterButton.selected").data("value")}function showPagination(){jQuery("#ResultsPaginationBottom").remove(),jQuery("#ResultsPagination").show(),jQuery("#ResultsPagination").clone(!0,!0).attr("id","ResultsPaginationBottom").insertAfter("[id^=EventSearchResults]"),jQuery("#ResultsPagination").scrollResults()}function populateResultsHeader(e,t,n){var a=createResultsHeader(e,t,n);jQuery("#ResultsHeader").html(a)}function populateResults(e){var t=getSelectedView(),n="";switch(t){case"day":n=createEventsListingDay(e);break;default:n=createEventsListing(e)}jQuery("#EventSearchResults").html(n)}function showNoResultsTemplate(e,t,n){populateResultsHeader(null,t,n);var a=createNoResultsTemplate();jQuery("#EventSearchResults").html(a)}function clearFormInputs(){jQuery("#ChoosePark, #ChooseState, #ChooseEventType").multiselect("deselectAll",!1),jQuery("#ChoosePark, #ChooseState, #ChooseEventType").multiselect("refresh"),jQuery("#form-keyword").val("")}function createEventsListing(e){var t="",n="",a="";return e.length<=0?createNoResultsTemplate():([].forEach.call(e,function(s,i){a=formatDateForEventsListingDateHeader(s),n===a?t+=createSingleEventListItem(s):(t+="</ul>",t+=createEventsListingDateHeader(e[i]),t+="<ul>",t+=createSingleEventListItem(e[i]),n=a)}),t+="</ul>")}function createEventsListingDay(e){if(e.length<=0)return createNoResultsTemplate();var t="<ul>";return[].forEach.call(e,function(e,n){t+=createSingleEventListItemDayView(e)}),t+="</ul>"}function createNoResultsTemplate(){var e="";return e+=' <div class="EventCalendar__NoResults">',e+='   <div class="EventCalendar__NoResults__Description">It doesn\'t look like there are any events to show.</div>',e+='     <div class="EventCalendar__NoResults__Icon">',e+='       <svg class="icon"><use xlink:href="/common/commonspot/templates/assets/sprite.symbol.svg#event-calendar_no-results"></use></svg>',e+="     </div>",e+='   <div class="EventCalendar__NoResults__Description">Try searching different dates or criteria.</div>',e+=" </div>",e+="</div>"}function createPaginationTemplate(e){var t="";if(null==e)t+='   <div class="ListingResults__Pagination col-md-5">',t+='     <span class="ListingResults__Pagination__TotalNum"> No results. </span>',t+="   </div>";else{var n=e.pageSize,a=1;e.pageNumber>1&&(n=e.pageNumber*e.pageSize,a=n-e.pageSize),n>e.totalNumber&&(n=e.totalNumber),t+='   <div class="ListingResults__Pagination col-md-5">',t+='     Showing <span class="ListingResults__Pagination__StartNum">'+a+"</span> -",t+='     <span class="ListingResults__Pagination__EndNum">'+n+"</span> of",t+='     <span class="ListingResults__Pagination__TotalNum">'+e.totalNumber+"</span> total results.",t+="   </div>"}return t}function createResultsHeader(e,t,n){var a="",s="",i=moment(t,"YYYY-MM-DD"),r=getSelectedView();switch(r){case"day":t=i.format("MMMM D, YYYY"),n=!1;break;case"week":var o=i.format("YYYY"),l=i.endOf("week").format("YYYY"),d=o!==l,c="MMMM D";d&&(c="MMMM D, YYYY"),t=i.startOf("week").format(c),n=i.endOf("week").format("MMMM D, YYYY");break;case"month":t=i.format("MMMM YYYY"),n=!1}"month"==r&&(s='<div class="row"><div class="ListingResults__Disclaimer col-md-12"><span class="blackhighlight">In Month View, only events from today or selected date to end of month are shown.</span></div></div>');var u=createPaginationTemplate(e);repeatingEventsAreHidden()&&(a='<div class="ListingResults__Heading__RepeatedEventsIndicator">Repeating instances of events are currently hidden</div>');var m='<div id="ListingResults__Heading">';return m+=' <div class="row">',m+='   <div class="ListingResults__Heading col-md-7">',m+='     <span class="ListingResults__Heading__PeriodType">'+r+"</span>",t&&(m+='   <span class="ListingResults__Heading__Period ListingResults__Heading__Period--Start">',"week"==r&&(m+="SUN, "),m+=t+"</span>"),n&&(m+='   &ndash; <span class="ListingResults__Heading__Period ListingResults__Heading__Period--End"> ',"week"==r&&(m+="SAT, "),m+=n+"</span>"),m+="   </div>",m+=u,m+=" </div>",m+=s,m+=a,m+="</div>"}function createSingleEventListItem(e){var t='<li class="ListingList__Item ListingResults__Item">';t+=' <div class="ListingEvent__Header">',t+='   <div class="row">',t+='     <div class="ListingEvent__TitleContainer col-sm-9 no-gutter">',t+='       <span class="ListingEvent__Subtitle">'+e.parkFullName+"</span>",t+='       <a href="'+EVENT_DETAIL_BASE_URL+e.id+'" class="ListingEvent__TitleLink">',t+='         <h3 class="ListingEvent__Title">'+e.title+"</h3>",t+="       </a>",t+="     </div>",t+=createEventLabelsTemplatePortion(e),t+="   </div>",t+=" </div>";var n=moment(e.dateStart),a=n.format("D"),s=n.format("MMM"),i="N/A";return Array.isArray(e.times)&&e.times.length&&e.times[0].hasOwnProperty("timeStart")&&(i=moment(e.times[0].timeStart,"H:mm a").format("h:mm a"),"Invalid date"==i&&(i="&nbsp;")),t+='<div class="row">',t+=" <div>",t+='   <div class="ListingEvent__QuickDate">',t+='     <span class="ListingEvent__QuickDate--Day">'+a+"</span>",t+='     <span class="ListingEvent__QuickDate--Month">'+s+"</span>",t+='     <span class="ListingEvent__QuickDate--Time">'+i+"</span>",t+="   </div>",t+=" </div>",t+=' <div class="ListingEvent__Info">',t+="   <table>",t+="     <tr>",t+='       <td class="ListingEvent__Info__Heading">Day(s):</td>',t+='       <td class="ListingEvent__Info__Data">'+createEventInfoDays(e)+"</td>",t+="     </tr>",t+="     <tr>",t+='       <td class="ListingEvent__Info__Heading">Date(s):</td>',t+='       <td class="ListingEvent__Info__Data">'+createEventInfoDates(e)+"</td>",t+="     </tr>",t+="     <tr>",t+='       <td class="ListingEvent__Info__Heading">Time(s):</td>',t+='       <td class="ListingEvent__Info__Data">'+createEventInfoTimes(e)+"</td>",t+="     </tr>",t+="     <tr>",t+='       <td class="ListingEvent__Info__Heading">Duration:</td>',t+='       <td class="ListingEvent__Info__Data">'+createEventInfoDuration(e)+"</td>",t+="     </tr>",t+="   </table>",t+=" </div>",t+="</div>",t+='<div class="row no-gutter"><a href="'+EVENT_DETAIL_BASE_URL+e.id+'" class="ListingResults__ViewDetailsLink carrot-end">View Details</a></div>',t+="</li>"}function createSingleEventListItemDayView(e){var t='<li class="ListingList__Item ListingResults__Item">';t+=' <div class="ListingEvent__Header">',t+='   <div class="row">',t+='     <div class="ListingEvent__TitleContainer col-sm-9 no-gutter">',t+='       <span class="ListingEvent__Subtitle">'+e.parkFullName+"</span>",t+='       <a href="'+EVENT_DETAIL_BASE_URL+e.id+'" class="ListingEvent__TitleLink">',t+='         <h3 class="ListingEvent__Title">'+e.title+"</h3>",t+="       </a>",t+="     </div>",t+=createEventLabelsTemplatePortion(e),t+="   </div>",t+=" </div>";var n=moment(e.dateStart),a=n.format("D"),s=n.format("MMM"),i="N/A";return Array.isArray(e.times)&&e.times.length&&e.times[0].hasOwnProperty("timeStart")&&(i=moment(e.times[0].timeStart,"H:mm a").format("h:mm a"),"Invalid date"==i&&(i="&nbsp;")),t+='<div class="row">',t+=" <div>",t+='   <div class="ListingEvent__QuickDate">',t+='     <span class="ListingEvent__QuickDate--Day">'+a+"</span>",t+='     <span class="ListingEvent__QuickDate--Month">'+s+"</span>",t+='     <span class="ListingEvent__QuickDate--Time">'+i+"</span>",t+="   </div>",t+=" </div>",t+=' <div class="ListingEvent__Info">',t+="   <table>",t+="     <tr>",t+='       <td class="ListingEvent__Info__Heading">Day(s):</td>',t+='       <td class="ListingEvent__Info__Data">'+createEventInfoDays(e)+"</td>",t+="     </tr>",t+="     <tr>",t+='       <td class="ListingEvent__Info__Heading">Date(s):</td>',t+='       <td class="ListingEvent__Info__Data">'+createEventInfoDates(e)+"</td>",t+="     </tr>",t+="     <tr>",t+='       <td class="ListingEvent__Info__Heading">Time(s):</td>',t+='       <td class="ListingEvent__Info__Data">'+createEventInfoTimes(e)+"</td>",t+="     </tr>",t+="     <tr>",t+='       <td class="ListingEvent__Info__Heading">Duration:</td>',t+='       <td class="ListingEvent__Info__Data">'+createEventInfoDuration(e)+"</td>",t+="     </tr>",t+="   </table>",t+=" </div>",t+=' <div class="ListingInfoExtended">',t+='   <div class="col-sm-12 col-md-4 col-md-push-8">',t+='     <div class="ListingMeta">',t+="       <table>",Array.isArray(e.types)&&e.types.length&&(t+='         <tr><td class="ListingMeta__Label">Type:</td><td>'+createEventInfoTypes(e)+"</td></tr>"),Array.isArray(e.TAGS)&&e.TAGS.length&&(t+='         <tr><td class="ListingMeta__Label">Tags:</td><td>'+createEventInfoTags(e)+"</td></tr>"),t+="       </table>",t+="     </div>",t+="   </div>",e.images.length&&(t+='   <div class="col-sm-12 col-md-8 col-md-pull-4 no-gutter">',t+='     <img class="ListingResults-thumbnail" src="https://www.nps.gov/'+e.images[0].path+'?width=150&height=150&bgcolor=888888&autorotate=false&quality=90" alt="thumbnail">',t+="   </div>"),t+=" </div>",t+="</div>",t+='<div class="row no-gutter"><a href="'+EVENT_DETAIL_BASE_URL+e.id+'" class="ListingResults__ViewDetailsLink carrot-end">View Details</a></div>',t+="</li>"}function createEventLabelsTemplatePortion(e){var t="";return Array.isArray(e.times)&&e.times.length&&e.times[0].hasOwnProperty("sunriseStart")&&(1===e.times[0].sunriseStart&&(t+='<div class="ListingEvent__EventTypesContainer col-sm-3 no-gutter">',t+=' <div class="ListingEvent__EventType ListingEvent__EventType--Sunrise">',t+='   <svg class="icon"><use xlink:href="/common/commonspot/templates/assets/sprite.symbol.svg#sunrise"></use></svg><span>Sunrise</span>',t+=" </div>"),1===e.times[0].sunsetEnd&&(t+=' <div class="ListingEvent__EventType ListingEvent__EventType--Sunset">',t+='   <svg class="icon"><use xlink:href="/common/commonspot/templates/assets/sprite.symbol.svg#sunset"></use></svg><span>Sunset</span>',t+=" </div>")),isRecurringEvent(e)&&(t+=' <div class="ListingEvent__EventType ListingEvent__EventType--Repeating">',t+='   <svg class="icon"><use xlink:href="/common/commonspot/templates/assets/sprite.symbol.svg#repeating-event"></use></svg><span>Repeating Event</span>',t+=" </div>"),isMultiDayEvent(e)&&(t+=' <div class="ListingEvent__EventType ListingEvent__EventType--MultiDay">',t+='   <svg class="icon"><use xlink:href="/common/commonspot/templates/assets/sprite.symbol.svg#multiday-event"></use></svg><span>Multiday Event</span>',t+=" </div>"),isSpecialEvent(e)&&(t+=' <div class="ListingEvent__EventType ListingEvent__EventType--GoldStar">',t+='   <svg class="icon"><use xlink:href="/common/commonspot/templates/assets/sprite.symbol.svg#gold-star"></use></svg><span>Special Event</span>',t+=" </div>",t+="</div>"),t}function createEventsListingDateHeader(e){var t=formatDateForEventsListingDateHeader(e);return'<div class="ListingResults__DateHeader"><span>'+t+"</span></div>"}function createEventInfoDays(e){if(isRecurringEvent(e)){var t=e.recurrenceRule.split("|"),n=new RRule(RRule.parseString(t[0])),a=moment(n.options.until).format("MMMM D, YYYY"),s=n.toText();s.indexOf("every week on Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday")!==-1&&(s=s.replace("every week on Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday","Every day"));var i=s.split("until");s=i[0]+"until "+a,s=s.charAt(0).toUpperCase()+s.slice(1);var r=[],o="";if(t.length>1&&0===t[1].indexOf("EXDATE=")){var l=t[1].substr(7);r=l.split(","),o+=" (except for ";for(var d=0;d<r.length;d++){var c=r.length>1,u=d===r.length-1&&c,m=d===r.length-2;u&&(o+="and ");var v=r[d],g=moment(v,"YYYY-MM-DD").format("MM/DD");o+=g,u||m||!c?!u&&c&&(o+=" "):o+=", "}""!==o.length&&(o+=")")}return s+o}return moment(e.dateStart,"YYYY-MM-DD").format("dddd")}function createEventInfoDates(e){var t=moment(e.dateStart,"YYYY-MM-DD").format("MMMM D, YYYY"),n=moment(e.dateEnd,"YYYY-MM-DD").format("MMMM D, YYYY");return isRecurringEvent(e)&&(n=moment(e.recurrenceDateEnd,"YYYY-MM-DD").format("MMMM D, YYYY")),isRecurringEvent(e)||isMultiDayEvent(e)?t+", to "+n:t}function createEventInfoTimes(e){var t="",n=!(!Array.isArray(e.times)||!e.times.length),a=!1,s=!1;return n?(t="<ul>",e.times.forEach(function(n){if(1==n.sunriseStart)a="Sunrise";else if(n.hasOwnProperty("timeStart")){var i=moment(n.timeStart,"HH:mm a");a=0==i.format("m")?i.format("h a"):i.format("h:mm a")}if(1==n.sunsetEnd)s="Sunset";else if(n.hasOwnProperty("timeEnd")){var r=moment(n.timeEnd,"HH:mm a");s=0==r.format("m")?r.format("h a"):r.format("h:mm a")}t+=a&&s?a===s?"<li>"+a+"</li>":"<li>"+a+" &mdash; "+s+"</li>":e.isAllDay?"<li>All day</li>":"<li>"+a+"</li>"}),t+="</ul>"):t="N/A",t}function createEventInfoDuration(e){var t="N/A",n=!(!Array.isArray(e.times)||!e.times.length);if(n){var a=e.times[0],s=!!(a.hasOwnProperty("timeStart")&&a.hasOwnProperty("timeEnd")&&a.timeStart.length>0&&a.timeEnd.length>0);if(e.hasOwnProperty("isAllDay")&&e.isAllDay===!0&&(t="All day."),s&&a.timeStart!==a.timeEnd){var i=moment(a.timeStart,"H:mm"),r=moment(a.timeEnd,"H:mm");a.timeStart.indexOf("PM")!==-1&&a.timeStart.indexOf("12:")==-1&&(i=i.add(12,"hours")),a.timeEnd.indexOf("PM")!==-1&&a.timeEnd.indexOf("12:")==-1&&(r=r.add(12,"hours"));var o=moment.duration(r.diff(i,"minutes")).milliseconds();o<0&&(o*=-1);var l=createEventInfoDurationString(o);t=l}}return t}function createEventInfoDurationString(e){var t="",n=Math.floor(e/60),a=e-60*n;return n>1?t+=n+" hours":1==n&&(t+="1 hour"),a>0&&(n>=1&&(t+=" and "),t+=a+" minutes"),t}function createEventInfoTags(e){return e.TAGS.join(", ")}function createEventInfoTypes(e){return e.types.join(", ")}function isSunriseOrSunsetEvent(e){return"undefined"!=typeof e.times[0]&&(1==e.times[0].sunsetEnd||1==e.times[0].sunriseStart)}function isSunriseEvent(e){return"undefined"!=typeof e.times[0]&&(1==e.times[0].sunsetEnd||1==e.times[0].sunriseStart)}function isRecurringEvent(e){return!!(e.isRecurring&&e.recurrenceRule.length>0)}function isMultiDayEvent(e){var t=moment(e.dateStart,"YYYY-MM-DD"),n=moment(e.dateEnd,"YYYY-MM-DD"),a=n.diff(t,"days");return a>0}function isSpecialEvent(e){return"Special Event"===e.category}function formatDateForEventsListingDateHeader(e){var t=document.querySelectorAll(".ResultsFilterButton.selected")[0],n="";return n=t?moment(e.dateStart).format("dddd, MMMM Do").toString():moment(e.dateStart).format("MMMM Do, YYYY").toString()}var EVENTS_API_BASE_URL="https://www.nps.gov/common/components/nps/eventcalendar/EventCalendarService.cfc?method=getEvents",EVENT_DETAIL_BASE_URL="https://www.nps.gov/planyourvisit/event-details.htm?id=";window.addEventListener("load",initEventCalendarPage),jQuery.fn.scrollResults=function(){return this.each(function(){jQuery("html, body").animate({scrollTop:jQuery(this).offset().top},1e3)})};